{% extends 'base.html.twig' %}
{% block body %}
    <div class="container-fluid">
        <h1 class="h3 mb-4 text-gray-800">Détails du Rapport</h1>
        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <h6 class="m-0 font-weight-bold text-primary">{{ report.title }}</h6>
            </div>
            <div class="card-body">
                <table class="table">
                    <tbody>
                        <tr><th>Id</th><td>{{ report.id }}</td></tr>
                        <tr><th>Titre</th><td>{{ report.title }}</td></tr>
                        <tr><th>Type</th><td>{{ report.type }}</td></tr>
                        <tr><th>Description</th><td>{{ report.description|nl2br }}</td></tr>
                        <tr><th>Statut</th><td>
                            {% if report.status == 'Validé' %}
                                <span class="badge badge-success">{{ report.status }}</span>
                            {% elseif report.status == 'En cours' %}
                                <span class="badge badge-primary">{{ report.status }}</span>
                            {% else %}
                                <span class="badge badge-secondary">{{ report.status }}</span>
                            {% endif %}
                        </td></tr>
                    </tbody>
                </table>

                {% if report.recommendations|length > 0 %}
                    <hr>
                    <div class="card shadow-sm mb-4 border-left-info">
                        <div class="card-header py-3 bg-light">
                            <h6 class="m-0 font-weight-bold text-info"><i class="fas fa-lightbulb mr-2"></i>Conseils et Recommandations de l'Admin</h6>
                        </div>
                        <div class="card-body">
                            <div class="list-group list-group-flush">
                                {% for recommendation in report.recommendations %}
                                    <div class="list-group-item px-0 {% if not recommendation.isReadByUser %}bg-light-blue{% endif %}">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <span class="badge badge-info"><i class="fas fa-clock mr-1"></i> {{ recommendation.createdAt|date('d/m/Y H:i') }}</span>
                                        </div>
                                        <div class="recommendation-text text-dark">
                                            {{ recommendation.content|raw|nl2br }}
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                {% endif %}

                <a href="{{ path('app_user_report_index') }}" class="btn btn-secondary">Retour à la liste</a>
                <a href="{{ path('app_user_report_edit', {'id': report.id}) }}" class="btn btn-warning">Modifier</a>
            </div>
        </div>
    </div>
{% endblock %}
